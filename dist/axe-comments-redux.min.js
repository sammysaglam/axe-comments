var AxeCommentsRedux=function(e){function t(r){if(n[r])return n[r].exports;var c=n[r]={i:r,l:!1,exports:{}};return e[r].call(c.exports,c,c.exports,t),c.l=!0,c.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=0)}([function(e,t,n){e.exports=n(1)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},c={csrfToken:null,comments:null,fetching:!1,abortFetch:!1};t.createReducer=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"/";return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:c,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};switch(n.type){case"axe-comments/update-csrf-token":return r({},t,{csrfToken:n.csrfToken});case"axe-comments/flag-as-fetching-comments":return r({},t,{fetching:!0,abortFetch:!1});case"axe-comments/fetch-comments":var o={};return o=t.abortFetch?{fetching:!1,abortFetch:!1}:{fetching:!1,comments:n.recentComments},r({},t,{newState:o});case"axe-comments/toggle-like":return r({},t,{abortFetch:!0,comments:t.comments.map(function(c){if(c.id===n.commentId){var o=c.rating,a={};if(1===parseInt(c["current_user-vote"])){o--;var s=new FormData;s.append("csrf",t.csrfToken),fetch(e+"unlike-comment/"+c.id,{credentials:"include",headers:new Headers({"X-Requested-With":"XMLHttpRequest"}),method:"POST",body:s}).then(function(e){return e.blob()}).then(function(e){!e.size&&n.errorCallback&&n.errorCallback()}),a=r({},c,{rating:o,"current_user-vote":0})}else{o++,-1===parseInt(c["current_user-vote"])&&o++;var u=new FormData;u.append("csrf",t.csrfToken),fetch(e+"like-comment/"+c.id,{credentials:"include",headers:new Headers({"X-Requested-With":"XMLHttpRequest"}),method:"POST",body:u}).then(function(e){return e.blob()}).then(function(e){!e.size&&n.errorCallback&&n.errorCallback()}),a=r({},c,{rating:o,"current_user-vote":1})}return a}return c})});case"axe-comments/toggle-dislike":return r({},t,{abortFetch:!0,comments:t.comments.map(function(c){if(c.id===n.commentId){var o=c.rating,a={};if(-1===parseInt(c["current_user-vote"])){o++;var s=new FormData;s.append("csrf",t.csrfToken),fetch(e+"undislike-comment/"+c.id,{credentials:"include",headers:new Headers({"X-Requested-With":"XMLHttpRequest"}),method:"POST",body:s}).then(function(e){return e.blob()}).then(function(e){!e.size&&n.errorCallback&&n.errorCallback()}),a=r({},c,{rating:o,"current_user-vote":0})}else{o--,1===parseInt(c["current_user-vote"])&&o--;var u=new FormData;u.append("csrf",t.csrfToken),fetch(e+"dislike-comment/"+c.id,{credentials:"include",headers:new Headers({"X-Requested-With":"XMLHttpRequest"}),method:"POST",body:u}).then(function(e){return e.blob()}).then(function(e){!e.size&&n.errorCallback&&n.errorCallback()}),a=r({},c,{rating:o,"current_user-vote":-1})}return a}return c})});case"axe-comments/delete-comment":var a=new FormData;return a.append("csrf",t.csrfToken),fetch(e+"delete-comment/"+n.commentId,{credentials:"include",headers:new Headers({"X-Requested-With":"XMLHttpRequest"}),method:"POST",body:a}),r({},t,{abortFetch:!0,comments:t.comments.filter(function(e){return e.id!==n.commentId})});default:return t}}},t.fetchComments=function(e){return function(t){return t({type:"axe-comments/flag-as-fetching-comments"}),fetch(e+"get-comments",{credentials:"include",headers:new Headers({"X-Requested-With":"XMLHttpRequest"})}).then(function(e){return e.json()}).then(function(e){t({type:"axe-comments/fetch-comments",comments:e.comments})})}}}]);